source('~/Documents/Classes/Fall 16/BIOSTAT 653/Biostat-653-Project/main.R', echo=TRUE)
View(eeg)
# check number
table(eeg$id)
mean(table(eeg$id))
min(table(eeg$id))
mean(table(eeg$id))
min(table(eeg$id))
max(table(eeg$id))
source('~/Documents/Classes/Fall 16/BIOSTAT 653/Biostat-653-Project/main.R', echo=TRUE)
View(eeg1)
hist(eeg1$attention_esense)
hist(eeg1$meditation_esense)
subset = eeg1[eeg1$signal_quality < 128]
subset = eeg1[,eeg1$signal_quality < 128]
subset = subset(eeg1, eeg1$signal_quality < 128)
hist(subset$attention_esense)
hist(subset$meditation_esense)
library(ggplot2)
library(MCMCglmm)
eeg1 = read.csv("eeg-data.csv")
metadata = read.csv("subject-metadata.csv")
metadata$id =metadata$ID
eeg = merge(eeg1, metadata, by="id")
eeg$indra_time = as.POSIXlt(eeg$indra_time)
eeg$indra_time_delta = as.numeric(difftime(eeg$indra_time,
min(eeg$indra_time), unit='secs'))
eeg_clean = subset(eeg, signal_quality < 128)
eeg_clean.sorted = eeg_clean[order(eeg_clean$id, eeg_clean$indra_time),]
time_delta=NULL
for(i in 1:30){
temp = as.numeric(difftime(eeg_clean.sorted[eeg_clean.sorted$id==i,]$indra_time,
min(eeg_clean.sorted[eeg_clean.sorted$id==i,]$indra_time), unit='secs'))
time_delta = c(time_delta, temp)
}
eeg_clean.sorted$time_delta = time_delta
group1 = subset(eeg_clean.sorted, eeg_clean.sorted$Session==1)
group2 = subset(eeg_clean.sorted, eeg_clean.sorted$Session==2)
session1 = subset(group1, group1$label!="unlabeled")
session2 = subset(group2, group2$label!="unlabeled")
session1$time_delta = session1$indra_time_delta - min(session1$indra_time_delta)
session2$time_delta = session2$indra_time_delta - min(session2$indra_time_delta)
eeg.final = rbind(session1, session2)
final.model = MCMCglmm(cbind(attention_esense, meditation_esense)~Session+time_delta+
Chosen.color+Gender, rcov= ~us(time_delta), random = ~ID+time_delta, family = c("gaussian", "gaussian"),
data=eeg.final)
?melt
library(reshape2)
?melt
colnames(eeg.final)
temp1 = eeg.final[,-c(6)]
temp2 = eeg.final[,-c(7)]
eeg.long = cbind(temp1, temp2)
View(eeg.long)
colnames(eeg.long)
dim(eeg.long)
dim(eeg.final)
eeg.long = rbind(temp1, temp2)
colnames(temp1$meditation_esense) = "response"
?rename
temp1 = rename(temp1, "meditation_esense"="response")
rename
names(temp1$meditation_esense) = "response"
colnames(temp1)
temp1$meditation_esense
temp1 = eeg.final[,-c(6)]
temp2 = eeg.final[,-c(7)]
colnames(temp1)
colnames(temp1)[6] = "response"
colnames(temp2)[6] = "response"
eeg.long = rbind(temp1, temp2)
colnames(eeg.long)
levels(eeg.long$response)
View(eeg.long)
length(temp1[,1])
meditate = rep("meditation", 9954)
meditate
attention = rep("attention", 9954)
temp1 = eeg.final[,-c(6)]
temp2 = eeg.final[,-c(7)]
colnames(temp1)[6] = "response_values"
colnames(temp2)[6] = "response_values"
meditate = rep("meditation", 9954)
attention = rep("attention", 9954)
eeg.long = rbind(temp1, temp2)
eeg.long$response = rbind(meditate, attention)
eeg.long$response = c(meditate, attention)
View(eeg.long)
length(eeg.long[,1])
?MCMCCglmm
?MCMCglmm
summary(eeg.final$X)
summary(rownames(eeg.final))
summary(as.numeric(rownames(eeg.final)))
eeg.final$units = as.numeric(rownames(eeg.final))
eeg.final$number = as.numeric(rownames(eeg.final))
final.model = MCMCglmm(cbind(attention_esense, meditation_esense)~Session+time_delta+
Chosen.color+Gender, rcov= ~us(time_delta):number, random = ~ID+time_delta,
family = c("gaussian", "gaussian"), data=eeg.final)
final.model = MCMCglmm(cbind(attention_esense, meditation_esense)~Session+time_delta+
Chosen.color+Gender, rcov= ~us(time_delta):units, random = ~ID+time_delta,
family = c("gaussian", "gaussian"), data=eeg.final)
final.model = MCMCglmm(cbind(attention_esense, meditation_esense)~Session+time_delta+
Chosen.color+Gender, rcov= ~us(1+time_delta):units, random = ~us(1+time_delta):ID,
family = c("gaussian", "gaussian"), data=eeg.final)
colnames(eeg.final)
length(colnames(eeg.final))
eeg.final[,-c(23)]
colnames(eeg.final)
eeg.finaleeg.final[,-c(23)]
eeg.final=eeg.final[,-c(23)]
colnames(eeg.final)
final.model = MCMCglmm(cbind(attention_esense, meditation_esense)~Session+time_delta+
Chosen.color+Gender, rcov= ~us(1+time_delta):units, random = ~us(1+time_delta):ID,
family = c("gaussian", "gaussian"), data=eeg.final)
final.model = MCMCglmm(cbind(attention_esense, meditation_esense)~Session+time_delta+
Chosen.color+Gender, rcov= ~us(1+time_delta):number, random = ~us(1+time_delta):ID,
family = c("gaussian", "gaussian"), data=eeg.final)
vignette("Overview", "MCMCglmm")
final.model = MCMCglmm(cbind(attention_esense, meditation_esense)~Session+time_delta+
Chosen.color+Gender, rcov= ~us(1+time_delta):number, random = ~time_delta,
family = c("gaussian", "gaussian"), data=eeg.final)
final.model = MCMCglmm(cbind(attention_esense, meditation_esense)~trait-1, rcov= ~us(trait):ID, random = ~us(trait):units,
family = c("gaussian", "gaussian"), data=eeg.final)
mean(group1$attention_esense)
mean(eeg.final$attention_esense)
mean(eeg.final$meditation_esense)
